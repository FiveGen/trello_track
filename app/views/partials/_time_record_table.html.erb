<% if @records.empty? %>
  <h4 style="text-align: center">There are no records between<br>
    <%= @start_time.strftime('%d.%m.%Y, %H:%M') %><br>
    and<br>
    <%= @human_end_time.strftime('%d.%m.%Y, %H:%M') %>
  </h4>
<% else %>
  <table class="table table-striped table-list">

    <thead>
      <tr>
        <th>Activity</th>
        <th>Time</th>
        <th>Duration</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>

      <% @records.each do |record| %>
        <tr>

          <td class="row-fluid span6">
            <ul class="breadcrumb row-fluid span10">
              <li>
                <blockquote class="pull-left">
                  <p class="pull-left">
                    <%= record.name %>
                  </p>
                </blockquote>
              </li>
            </ul>
          </td>

          <td class="row-fluid span2">
            <div class="row-fluid span12">
              <blockquote>
                <h5 class="started_at">
                  <%= '<span class="icon-arrow-left" title="Activity continues..."></span>'.html_safe if record.over(@start_time) %>
                  <%= format_with_day(record.start_time_capped_by(@start_time), record.start_time_capped_by(@start_time), record.end_time_capped_by(@end_time)) %>
                </h5>
              </blockquote>
              <blockquote>
                <h5 class="ended_at">
                  <%= (format_with_day(record.end_time_capped_by(@end_time), record.start_time_capped_by(@start_time), record.end_time_capped_by(@end_time))) unless record.end_time.nil? %>
                  <%= '<span class="icon-arrow-right" title="Activity continues..."></span>'.html_safe if record.over(@end_time) %>
                </h5>
              </blockquote>
            </div>
          </td>

          <td class="row-fluid span3">
            <h5 class="time-spent" >
              <%= record.human_total_time_capped_by(@start_time, @end_time)[:diff] unless record.end_time.nil? %>
              <%= '<span title="Activity continues...">*</span>'.html_safe if record.over(@end_time) or record.over(@start_time) %>
            </h5>
          </td>

          <td class="row-fluid span1">
            <div class="btn-group">
              <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                <i class="icon-edit icon-white"></i>
                <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                <li>
                  <%= link_to '<i class="icon-edit"></i> Details & Edit'.html_safe, edit_time_record_path(record.id) %>
                </li>
                <li>
                  <%= link_to '<i class="icon-trash"></i> Destroy'.html_safe, record, method: :delete, data: { confirm: 'Are you sure?' } %>
                </li>
              </ul>
            </div>
          </td>

        </tr>

      <% end %>

    </tbody>

  </table>
<hr>
<div class="container row">
  <div class="span3 pull-right">
    <h4 id="total_time"><%= "%02d:%02d:%02d" % [(@total_seconds / 3600).to_i, ((@total_seconds % 3600) / 60).to_i, (@total_seconds % 60).to_i] %></h4>
  </div>
  <div class="span1 pull-right">
    <h4>Total:</h4>
  </div>
</div>
<% end %>
